task deploy {
    dependsOn assemble, unZipJacocoAgent
}

deploy << {
    def JAVA_AGENT="-javaagent:$buildDir/jacocoagent/jacocoagent.jar=destfile=$buildDir/jacoco/functionalTest.exec"

    "java $JAVA_AGENT -jar $jar.archivePath".execute()
    Thread.sleep(3000)
}

task undeploy << {
    def pid = file('application.pid').text
    "kill $pid".execute().waitFor()
}
